---
const today = new Date();
import contactIconRaw from "../../assets/icons/resume-icon.svg?raw";
import Button from "../ui/button/Button.astro";
import GlowLineSeparator from "../ui/separator/GlowLineSeparator.astro";
import mailIconRaw from "../../assets/icons/contact-icon.svg?raw";
import itchioIconRaw from "../../assets/logos/itchio-logo.svg?raw"
import twitterIconRaw from "../../assets/icons/x-blog-post-share-icon.svg?raw"
import githubIconRaw from "../../assets/logos/source_control/01-GitHub-logo.svg?raw"
import linkdinIconRaw from "../../assets/icons/linkedin.svg?raw"

function sanitizeToPureWhite(svg: string, size = 20) {
  let s = svg
    .replace(/<\?xml[\s\S]*?\?>/g, "")
    .replace(/<!--[\s\S]*?-->/g, "")
    .replace(/<style[\s\S]*?<\/style>/gi, "")
    .replace(/\swidth="[^"]*"/gi, "")
    .replace(/\sheight="[^"]*"/gi, "")
    // elimina posibles fondos (rectángulos/círculos de marca)
    .replace(/<rect[\s\S]*?\/>/gi, "")
    .replace(/<circle[\s\S]*?\/>/gi, "")
    .replace(/<ellipse[\s\S]*?\/>/gi, "")
    // atributos fill: respeta none; el resto -> blanco
    .replace(/\sfill="(?!none")[^"]*"/gi, ' fill="#06B6D4"')
    // estilos embebidos
    .replace(/\sstyle="[^"]*"/gi, (m) =>
      m.replace(/fill:\s*(?!none)[^;"]*;?/gi, "fill: #06B6D4;")
       .replace(/stroke:\s*[^;"]*;?/gi, "stroke: none;")
    )
    // stroke -> none
    .replace(/\sstroke="[^"]*"/gi, ' stroke="none"');

  // añade fill blanco cuando NO hay fill (paths negros por defecto)
  s = s.replace(/<path(?![^>]*\sfill=)([^>]*)>/gi, '<path fill="#06B6D4"$1>');
  s = s.replace(/<polygon(?![^>]*\sfill=)([^>]*)>/gi, '<polygon fill="#06B6D4"$1>');
  s = s.replace(/<polyline(?![^>]*\sfill=)([^>]*)>/gi, '<polyline fill="#06B6D4"$1>');

  // asegura tamaño
  s = s.replace(/<svg([^>]*)>/i, (m, attrs) =>
    `<svg${attrs} width="${size}" height="${size}" focusable="false" aria-hidden="true">`
  );
  return s;
}

const contactIcon = sanitizeToPureWhite(contactIconRaw);
const mailIcon = sanitizeToPureWhite(mailIconRaw);
const twitterIcon = sanitizeToPureWhite(twitterIconRaw);
const githubIcon = sanitizeToPureWhite(githubIconRaw);
const linkdinIcon = sanitizeToPureWhite(linkdinIconRaw);

const feedUrl = new URL('rss.xml', Astro.site).toString();
---

<GlowLineSeparator></GlowLineSeparator>

<footer id="contact" class="py-12 px-4 text-center">
  <h2 class="text-2xl md:text-3xl font-semibold text-foreground">CONTACT & CV</h2>
  <p class="mt-2 text-[color:var(--color-text-muted)]">Want to know more about my journey? Here’s my CV.</p>

  <div class="mt-8 flex justify-center">
    <Button href="/portfolio_astro_page/CV_Nahuel_ENG.pdf" variant="secondary" size="md">
      <span class="inline-flex mr-2" aria-hidden="true" set:html={contactIcon} />
      Download CV
    </Button>
  </div>

    <div class="mt-5 flex justify-center items-center gap-2 text-foreground">
      
    <span class="inline-flex" aria-hidden="true" set:html={mailIcon} />
    <a href="https://mail.google.com/mail/?view=cm&to=nahuel.ap.code@gmail.com" class="no-underline text-foreground hover:opacity-80">nahuel.ap.code@gmail.com</a>
  </div>


  <div class="mt-5 flex justify-center items-center gap-4 text-foreground leading-none">
    <a href="https://www.linkedin.com/in/nahuel-aparicio-del-blanco-193234327/" class="inline-flex align-middle hover:opacity-80" target="_blank" rel="noopener" set:html={sanitizeToPureWhite(linkdinIcon, 40)} />
    <a href="https://github.com/NahuelAparicio10" class="inline-flex align-middle hover:opacity-80" target="_blank" rel="noopener" set:html={sanitizeToPureWhite(githubIconRaw, 40)} />
    <a href="https://nahuelcode.itch.io/" class="inline-flex align-middle hover:opacity-80" target="_blank" rel="noopener" set:html={sanitizeToPureWhite(itchioIconRaw, 40)} />
    <a href="https://x.com/naguuu10" class="inline-flex align-middle hover:opacity-80" target="_blank" rel="noopener" set:html={sanitizeToPureWhite(twitterIconRaw, 40)} />
  </div>
</footer>
